#!/usr/bin/env ruby

$LOAD_PATH.unshift(File.expand_path(File.dirname(__FILE__) + '/../lib'))

require 'mechanize'
require 'ap'
require 'logger'
require 'cross'


ap "cross " + Cross::VERSION + " (C) 2011, 2012 - paolo@armoredcode.com"

engine = Cross::Engine.instance
engine.start

raise "cross: missing target" if ARGV[0].nil?
ap "Canary found in output page. Suspected XSS" if engine.inject(ARGV[0])
