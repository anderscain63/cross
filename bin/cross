#!/usr/bin/env ruby

$LOAD_PATH.unshift(File.expand_path(File.dirname(__FILE__) + '/../lib'))

require 'mechanize'
require 'ap'
require 'logger'
require 'cross'


host = Cross::Host.new(ARGV[0])
ap "cross " + Cross::Version.version[:string] + " (C) 2011 - thesp0nge"
ap "target: " + host.host

engine = Cross::Engine.instance
engine.start

if engine.inject(ARGV[0])
  ap "Canary found in output page. Suspected XSS"
end
